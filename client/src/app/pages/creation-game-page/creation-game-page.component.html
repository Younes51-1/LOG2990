<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.1/css/all.css" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" />
<div class="container" (mouseup)="handleMouseUp()">
    <header>
        <button class="config-button" routerLink="/config">
            <i class="fa fa-cog fa-3x" aria-hidden="true"></i>
        </button>
        <img src="./assets/pictures/creation.png" />
    </header>
    <p>* Les images doivent posséder le format 24-bit bitmap (BPM) avec une taille de 640x480 px *</p>
    <label class="custom-file-upload">
        <i class="fas fa-upload"></i>Téléverser deux images simultanément <input #images1et2 type="file"
            accept="image/bmp" (change)="verifyImageFormat($event, images1et2)" data-input="false"
            style="display:none" />
    </label>
    <button class="custom-button" (click)="reset(images1et2)">
        <i class="fas fa-trash-alt"></i>Réinitialiser deux images simultanément
    </button>
    <section class="canvas">
        <div class="canvas1">
            <label class="custom-file-upload">
                <i class="fas fa-upload"></i>Téléverser l'image originale
                <input #image1 type="file" accept="image/bmp" (change)="verifyImageFormat($event, image1)"
                    data-input="false" style="display:none">
            </label>
            <button class="custom-button" (click)="reset(image1)">
                <i class="fas fa-trash-alt"></i>Réinitialiser l'image originale
            </button>
            <canvas #canvas1 (mousedown)="handleCanvasEvent('mousedown', $event, canvas1)"
                (mousemove)="handleCanvasEvent('mousemove', $event, canvas1)"
                (mouseup)="handleCanvasEvent('mouseup', $event, canvas1)"
                (mouseleave)="handleCanvasEvent('mouseleave', $event, canvas1)"
                (mouseenter)="handleCanvasEvent('mouseenter', $event, canvas1)" [attr.width]="width"
                [attr.height]="height"></canvas>
            <button class="button" (click)="reset(canvas1)">Réinitialiser l'avant-plan</button>
        </div>
        <div class="swap">
            <button class="button" (click)="duplicateForeground(canvas1)"><i class="fa fa-arrow-right"></i></button>
            <button class="button" (click)="pushAndSwapForegrounds()"><i class="fas fa-exchange-alt"></i></button>
            <button class="button" (click)="duplicateForeground(canvas2)"><i class="fa fa-arrow-left"></i></button>
        </div>
        <div class="canvas2">
            <label class="custom-file-upload">
                <i class="fas fa-upload"></i>Téléverser l'image modifiée<input #image2 type="file" accept="image/bmp"
                    (change)="verifyImageFormat($event, image2)" data-input=" false" style="display:none" /></label>
            <button class="custom-button" (click)="reset(image2)">
                <i class="fas fa-trash-alt"></i>Réinitialiser l'image modifiée
            </button>
            <canvas #canvas2 (mousedown)="handleCanvasEvent('mousedown', $event, canvas2)"
                (mousemove)="handleCanvasEvent('mousemove', $event, canvas2)"
                (mouseup)="handleCanvasEvent('mouseup', $event, canvas2)"
                (mouseleave)="handleCanvasEvent('mouseleave', $event, canvas2)"
                (mouseenter)="handleCanvasEvent('mouseenter', $event, canvas2)" [attr.width]="width"
                [attr.height]="height"></canvas>
            <button class="button" (click)="reset(canvas2)">Réinitialiser l'avant-plan</button>
        </div>
    </section>
    <div class="tools">
        <button class="button action" (mouseenter)="enableMode('pencil')">
            <div class="paint-picker-container">
                <label for="colorpicker">Couleur</label>
                <input id="colorpicker" [(colorPicker)]="color" [style.background]="color" />
                <label for="pencilSize">Épaisseur du trait ({{ pencilSize }} px) </label>
                <mat-slider id="pencilSize" min="1" max="100" step="1" [(ngModel)]="pencilSize"
                    class="paint-picker-container">
                    <input matSliderThumb />
                </mat-slider>
            </div>
            <i class="fas fa-pencil-alt"></i>
        </button>
        <button class="button action" (mouseenter)="enableMode('rectangle')">
            <div class="paint-picker-container">
                <label for="colorpicker">Couleur</label>
                <input id="colorpicker" [(colorPicker)]="color" [style.background]="color" />
            </div>
            <i class="fas fa-vector-square"></i>
        </button>
        <button class="button action" (mouseenter)="enableMode('eraser')">
            <div class="paint-picker-container">
                <label for="eraserSize">Taille de l'efface ({{ eraserSize }} px)</label>
                <mat-slider id="eraserSize" min="1" max="100" step="1" [(ngModel)]="eraserSize">
                    <input matSliderThumb />
                </mat-slider>
            </div>
            <i class="fa fa-eraser"></i>
        </button>
        <button class="button" (click)="ctrlZ()"><i class="fas fa-undo"></i></button>
        <button class="button" (click)="ctrlShiftZ()"><i class="fas fa-redo"></i></button>
    </div>
    <section class="footer">
        <fieldset>
            <legend>Paramètres du rayon d'élargissement</legend>
            <div *ngFor="let radius of possibleRadius">
                <input *ngIf="radius !== 3" type="radio" #rayon{{radius}} name="choixRayon" value="{{ radius }}"
                    (click)="updateRadius(radius)" />
                <input *ngIf="radius === 3" type="radio" #rayon{{radius}} name="choixRayon" value="{{ radius }}"
                    (click)="updateRadius(radius)" checked />
                <label for="rayon{{ radius }}">{{ radius }} </label>
            </div>
        </fieldset>
        <button
            *ngIf="(image1?.value !== '' && image2?.value !== '') || images1et2?.value !== '' || this.undo.length > 0"
            class="button" (click)="runDetectionSystem()">
            Visualiser les différences
        </button>
    </section>
</div>